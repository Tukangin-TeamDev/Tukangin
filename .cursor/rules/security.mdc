---
description: 
globs: 
alwaysApply: true
---
7. Keamanan Tambahan
7.1. Autentikasi dan 2FA
•	JWT untuk Autentikasi Stateless: Token dikeluarkan saat login dan disimpan di cookie HttpOnly.
•	2FA (Two-Factor Authentication): Implementasi opsi 2FA untuk login akun sensitif, terutama bagi admin dan provider. Penggunaan OTP (SMS/email) atau aplikasi authenticator, yang harus diverifikasi sebelum mengizinkan akses ke fitur kritis.
7.2. Audit Log
•	Audit Logging di Admin: Setiap aktivitas kritis (login, perubahan data profil, transaksi, dispute) dicatat melalui middleware audit log. Log disimpan di database khusus atau modul service dan dapat diakses oleh admin pada dashboard audit log.
•	Format Log: Catatan harus mencakup userID, peran, aktivitas, timestamp, dan hasil aksi.
7.3. Validasi Input dan Sanitasi
•	Input Validation: Gunakan library validasi (misalnya, Joi atau Zod) pada setiap endpoint API.
•	Sanitasi Input dan Output: Gunakan mekanisme sanitasi untuk mencegah injection dan XSS (misalnya, express-mongo-sanitize, helmet).

